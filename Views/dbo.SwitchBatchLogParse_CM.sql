create view SwitchBatchLogParse_CM as
select flowName
,a.PKID
,a.ordersProductsID
,a.batchTimestamp
,b.*
--,a.jsonData
from dbo.tblSwitchBatchLog a
cross apply openjson(jsonData) 
with 
(json_PKID int '$.PKID'
,json_orderID int '$.orderID'
,json_orderNo nvarchar(255) '$.orderNo'
,json_orderDate datetime '$.orderDate'
,json_customerID int '$.customerID'
,json_shippingAddressID int '$.shippingAddressID'
,json_shipCompany nvarchar(255) '$.shipCompany'
,json_shipFirstName nvarchar(255) '$.shipFirstName'
,json_shipLastName nvarchar(255) '$.shipLastName'
,json_shipAddress1 nvarchar(255) '$.shipAddress1'
,json_shipAddress2 nvarchar(255) '$.shipAddress2'
,json_shipCity nvarchar(255) '$.shipCity'
,json_shipState nvarchar(255) '$.shipState'
,json_shipZip nvarchar(255) '$.shipZip'
,json_shipCountry nvarchar(255) '$.shipCountry'
,json_shipPhone nvarchar(255) '$.shipPhone'
,json_productCode nvarchar(50) '$.productCode'
,json_productName nvarchar(255) '$.productName'
,json_shortName nvarchar(255) '$.shortName'
,json_productQuantity int '$.productQuantity'
,json_packetValue nvarchar(50) '$.packetValue'
,json_variableTopName nvarchar(255) '$.variableTopName'
,json_variableBottomName nvarchar(255) '$.variableBottomName'
,json_variableWholeName nvarchar(255) '$.variableWholeName'
,json_backName nvarchar(255) '$.backName'
,json_numUnits int '$.numUnits'
,json_displayedQuantity int '$.displayedQuantity'
,json_ordersProductsID int '$.ordersProductsID'
,json_shipsWith nvarchar(255) '$.shipsWith'
,json_resubmit bit '$.resubmit'
,json_shipType nvarchar(50) '$.shipType'
,json_samplerRequest nvarchar(50) '$.samplerRequest'
,json_multiCount int '$.multiCount'
,json_totalCount int '$.totalCount'
,json_displayCount nvarchar(50) '$.displayCount'
,json_background nvarchar(255) '$.background'
,json_templateFile nvarchar(255) '$.templateFile'
,json_team1FileName nvarchar(255) '$.team1FileName'
,json_team2FileName nvarchar(255) '$.team2FileName'
,json_team3FileName nvarchar(255) '$.team3FileName'
,json_team4FileName nvarchar(255) '$.team4FileName'
,json_team5FileName nvarchar(255) '$.team5FileName'
,json_team6FileName nvarchar(255) '$.team6FileName'
,json_groupID int '$.groupID'
,json_productID int '$.productID'
,json_parentProductID int '$.parentProductID'
,json_switch_create bit '$.switch_create'
,json_switch_createDate datetime '$.switch_createDate'
,json_switch_approve bit '$.switch_approve'
,json_switch_approveDate datetime '$.switch_approveDate'
,json_switch_print bit '$.switch_print'
,json_switch_printDate datetime '$.switch_printDate'
,json_switch_import bit '$.switch_import'
,json_mo_orders_Products datetime '$.mo_orders_Products'
,json_mo_orders datetime '$.mo_orders'
,json_mo_customers datetime '$.mo_customers'
,json_mo_customers_ShippingAddress datetime '$.mo_customers_ShippingAddress'
,json_mo_oppo datetime '$.mo_oppo'
,json_customProductCount int '$.customProductCount'
,json_customProductCode1 nvarchar(50) '$.customProductCode1'
,json_customProductCode2 nvarchar(50) '$.customProductCode2'
,json_customProductCode3 nvarchar(50) '$.customProductCode3'
,json_customProductCode4 nvarchar(50) '$.customProductCode4'
,json_fasTrakProductCount int '$.fasTrakProductCount'
,json_fasTrakProductCode1 nvarchar(50) '$.fasTrakProductCode1'
,json_fasTrakProductCode2 nvarchar(50) '$.fasTrakProductCode2'
,json_fasTrakProductCode3 nvarchar(50) '$.fasTrakProductCode3'
,json_fasTrakProductCode4 nvarchar(50) '$.fasTrakProductCode4'
,json_stockProductCount int '$.stockProductCount'
,json_stockProductQuantity1 int '$.stockProductQuantity1'
,json_stockProductCode1 nvarchar(50) '$.stockProductCode1'
,json_stockProductDescription1 nvarchar(255) '$.stockProductDescription1'
,json_stockProductQuantity2 int '$.stockProductQuantity2'
,json_stockProductCode2 nvarchar(50) '$.stockProductCode2'
,json_stockProductDescription2 nvarchar(255) '$.stockProductDescription2'
,json_stockProductQuantity3 int '$.stockProductQuantity3'
,json_stockProductCode3 nvarchar(50) '$.stockProductCode3'
,json_stockProductDescription3 nvarchar(255) '$.stockProductDescription3'
,json_stockProductQuantity4 int '$.stockProductQuantity4'
,json_stockProductCode4 nvarchar(50) '$.stockProductCode4'
,json_stockProductDescription4 nvarchar(255) '$.stockProductDescription4'
,json_stockProductQuantity5 int '$.stockProductQuantity5'
,json_stockProductCode5 nvarchar(50) '$.stockProductCode5'
,json_stockProductDescription5 nvarchar(255) '$.stockProductDescription5'
,json_stockProductQuantity6 int '$.stockProductQuantity6'
,json_stockProductCode6 nvarchar(50) '$.stockProductCode6'
,json_stockProductDescription6 nvarchar(255) '$.stockProductDescription6'
,json_UV int '$.UV'
,json_customBackground nvarchar(255) '$.customBackground'
) as b
where flowName = 'CM'